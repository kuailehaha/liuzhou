# RULES 六洲棋规则

1. 基本信息
棋盘：6×6 的方格，共 36 个交叉点。
棋子：黑白双方各执一色，交替落子或走子。
游戏分为三个阶段：第一阶段（落子）、第二阶段（标记棋子的移除或强制指定移除）、第三阶段（走子与提吃）。最终目标是通过提吃，使得对方棋子全部被移除，即可获胜。

2. 专有名词：方、洲、标记、提吃
方：由 4 枚*未被标记的*同色棋子组成的 2×2 正方形区域（如 (r, c), (r, c+1), (r+1, c), (r+1, c+1)），即一个紧挨着的"小方块"。
洲：由 6 枚*未被标记的*同色棋子在水平或垂直方向上连续排列（不可有空格或其它颜色插入）。不考虑斜线。
标记
仅在第一阶段发生。
当一方落子后，若*该落子本身未被对方标记过，且*形成「方」或「洲」，则可标记若干对方棋子：
形成方：可标记 1 颗对方棋子
形成洲：可标记 2 颗对方棋子
如果一次落子同时形成「方」和「洲」，则按「洲」的规则标记（即标记 2 颗对方棋子）。
*标记对方棋子时，不能标记对方已经被标记的棋子，也不能标记对方正处于"方"或"洲"结构中的棋子。*
已被标记的棋子在第一阶段并不立刻被移除，而是要等到第二阶段统一处理。
*如果当前落下的这颗棋子本身已被对方标记，则即使它参与形成了新的"方"或"洲"，也不能触发对对方棋子的标记。*
提吃
仅在第三阶段发生。
当一方移动自己的棋子后，如果形成了「方」或「洲」，则可提吃对手若干颗棋子：
形成方：提吃对手 1 颗棋子
形成洲：提吃对手 2 颗棋子
被提吃的棋子立即从棋盘上移除。
3. 游戏流程
阶段 1：落子阶段
下子顺序：黑棋先行，双方轮流各下一子，直到棋盘上的 36 个交叉点全部放满棋子。
*落子时，不能落在已被对方标记的位置上。*
每次落子后：
若当前落子未被对方标记：
检查是否形成「方」或「洲」。
若形成，则按规则标记对方的棋子（形成「方」标记1颗，形成「洲」标记2颗；同时形成则按「洲」标记2颗）。
*标记对方棋子时，不能标记对方已经被标记的棋子，也不能标记对方正处于"方"或"洲"结构中的棋子。*
落子结束条件：
当所有 36 个交叉点均被放置棋子后，第一阶段结束，进入第二阶段。
阶段 2：标记棋子的移除 或 强制指定移除
分两种情况：
*情况一：若在第一阶段结束时，棋盘上没有任何棋子被标记*
则进入"强制指定移除"流程：
1. 由白方先手，指定移除对方（黑方）的一枚棋子。被移除的棋子不能是构成"方"或"洲"的棋子。
2. 然后由黑方指定移除对方（白方）的一枚棋子。被移除的棋子不能是构成"方"或"洲"的棋子。
3. 完成后，进入第三阶段，由白方先行。
*情况二：若在第一阶段结束时，棋盘上至少有一枚棋子被标记*
则将棋盘上所有被标记的棋子（无论黑白）一次性全部移除。
完成后，进入第三阶段，由白方先行。
阶段 3：走子与提吃
开局：白方先行，然后黑白轮流走子。
走子规则：
一次走子只能移动己方的一颗棋子，且只能水平或垂直移动1 步（不允许跳跃、不允许斜向）。
如果相邻的格子已被任何棋子占据，则不能走到那个方向。
走子后若形成「方」或「洲」，则立刻提吃对手若干颗棋子（提吃 1 或 2 颗，具体数量同第一阶段的标记规则）。
无子可动的处理：
如果轮到某一方走子时，该方所有棋子都被堵住，无法移动到相邻空位，则该方可以先移除 1 颗对手的棋子（但不允许移除对手已经形成特殊棋形的关键棋子；换言之，不能移除此刻正处于"方"或"洲"结构中的那几颗对手棋子）。
紧接着，对手也移除 1 颗该方的棋子（同样的限制，不可移除对方正在构成特殊形的棋子）。
然后回到原先无法动的一方，尝试继续走子：
如果经过这样的一轮互相移除之后，该方出现了可走的空位，就执行正常走子；
如果仍然不可动，是否可以再次触发移除？（根据规则叙述，通常不会无限循环，因为移除了对手的一颗后，对方也移除我方的一颗，棋盘情况改变，最终会出现可移动的情况。规则里说明"不会发生卡住的情况"。）
胜负判定：
任意时刻，若对手的所有棋子都被提吃（或在无子可动时被移除到 0），则己方获胜。
根据规则说明，"不会发生最终卡住的情况"。

平局判定（实现层面）：
为防止无限循环并保证训练效率，系统引入两条平局规则：
1. **总步数上限**：总步数达到 144 步（`MAX_MOVE_COUNT = 144`）仍无人获胜，则判定平局。
2. **无吃子判和**：进入走子阶段后，连续 36 步（`NO_CAPTURE_DRAW_LIMIT = 36`，即 18 个完整回合）双方均未发生吃子，则判定平局。系统通过 `moves_since_capture` 计数器追踪无吃子步数，每次吃子时重置。



